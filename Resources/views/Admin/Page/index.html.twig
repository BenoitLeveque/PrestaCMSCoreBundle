{#
/**
 * This file is part of the Presta Bundle project.
 *
 * (c) Nicolas Bastien nbastien@prestaconcept.net
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
/**
 * Page administration main screen 
 */
#}

{% extends base_template %}


{% block stylesheets %}
    {{ parent() }}
    {% stylesheets
        '@PrestaCMSCoreBundle/Resources/public/jstree/dist/themes/presta/style.css'
    %}

    <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}

{% endblock %}

        
{% block javascripts %}
    {{ parent() }}
    {% javascripts
        '@PrestaCMSCoreBundle/Resources/public/jstree/dist/jstree.min.js'
        '@PrestaCMSCoreBundle/Resources/public/js/cms.js'
    %}

    <script type="text/javascript" src="{{ asset_url }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/prestaassettinymce/js/tiny_mce/tiny_mce.js') }}"></script>
    {% endjavascripts %}
    <script type="text/javascript">
        $(document).ready(function() {
            {% for key, navigation in navigations %}
            // call `.jstree` with the options object
            $("#jstree_{{ key }}").jstree({
                // the `plugins` array allows you to configure the active plugins on this instance
                "plugins" : ["themes","html_data"],
                // each plugin you have included can have its own config object
                "core" : {  },
                // it makes sense to configure a plugin only if overriding the defaults
                "themes" : {
                    "theme" : "presta"
                }
            });
            {% endfor %}
        });
    </script>
{% endblock %}


{% block side_menu %}
    {% include 'PrestaCMSCoreBundle:Admin/Page:_sidebar.html.twig' %}
{% endblock %}

{% block title %}
    {% if (page) %}
        {{ page.name }}
    {% endif %}
{% endblock %}

{%block actions %}
    {% if (page) %}
        <div class="btn-group nav-pills">
            <a class="btn btn-danger" type="button"><i class="icon-remove icon-white"></i>&nbsp;Delete</a>
            {# <button class="btn" type="button"><i class="icon-screenshot "></i>&nbsp;Preview</button>
            <button class="btn btn-success" type="button"><i class="icon-retweet icon-white"></i>&nbsp;Publish</button> #}
            <a class="btn btn-primary" onclick="$('#edit_form').submit();"><i class="icon-ok icon-white"></i>&nbsp;Save</a>
        </div>
    {% endif %}
{% endblock %}

{% block content %}
    {% if (page) %}
        <ul class="nav nav-tabs">
            {% for type, tab in pageEditTabs %}
                <li><a href="#{{ [type, '-', tab]|join }}" data-toggle="tab">{{ [type, '-', tab]|join }}</a></li>
            {% endfor %}
            <li><a href="#seo" data-toggle="tab">SEO</a></li>
            <li><a href="#settings" data-toggle="tab">Settings</a></li> 
        </ul>
        <form id="edit_form" class="form-horizontal" method="POST">
            {% form_theme form 'PrestaSonataAdminBundle:Form:form_admin_fields.html.twig' %}

            <div class="tab-content">
                {% for type, tab in pageEditTabs %}
                <div class="tab-pane form-horizontal" id="{{ [type, '-', tab]|join }}">
                    {% render "PrestaCMSCoreBundle:Admin/Page:renderEditTab" with {'type': type, 'tab': tab, 'page': page} %}
                </div>
                {% endfor %}
                <div class="tab-pane form-horizontal" id="seo">
                    <fieldset>
                        <legend>SEO</legend>
                        <div class="sonata-ba-collapsed-fields">
                            {{ form_row(form.url)}}
                            {{ form_row(form.title)}}
                            {{ form_row(form.metaKeywords)}}
                            {{ form_row(form.metaDescription)}}
                        </div>
                    </fieldset>
                </div>
                <div class="tab-pane form-horizontal" id="settings">
                    <fieldset>
                        <legend>Settings</legend>
                        {{ form_row(form.name)}}
                        {{ form_row(form.active)}}
                        {{ form_row(form.settings)}}
                        {{ form_rest(form) }}
                    </fieldset>
                </div>
            </div>

        </form>
    {% endif %}
{% endblock %}